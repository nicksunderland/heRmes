<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tools Used By The HERMES Consortium • heRmes</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Tools Used By The HERMES Consortium">
<meta name="description" content="A collection of tools for phenotyping and processing heart failure GWAS data.">
<meta property="og:description" content="A collection of tools for phenotyping and processing heart failure GWAS data.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">heRmes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/hermes_3.html">HERMES 3.0</a></li>
    <li><a class="dropdown-item" href="articles/hermes_qc_script.html">HERMES QUALITY CONTROL</a></li>
    <li><a class="dropdown-item" href="articles/hermes3_ukbb_phenotyping.html">HERMES3 PHENOTYPING</a></li>
    <li><a class="dropdown-item" href="articles/ukbb_phenotyping.html">UKBB phenotyping example</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="hermes-">heRmes <img src="reference/figures/hex.png" align="right" width="190"><a class="anchor" aria-label="anchor" href="#hermes-"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The goal of <strong>heRmes</strong> is to standardise the heart failure phenotyping of collections of electronic health records.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the latest version of <strong>heRmes</strong> like so:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"nicksunderland/heRmes"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phenotypes">Phenotypes<a class="anchor" aria-label="anchor" href="#phenotypes"></a>
</h2>
<p>The code lists underpinning the various phenotypes are stored in text files within the package structure at: <code>inst/extdata/ukhdr_phenotypes</code>. The format of the file matches that used by the <a href="https://phenotypes.healthdatagateway.org" class="external-link">UKHDR Phenotype Library</a>, but the important columns are: <code>code</code>, <code>description</code>, <code>coding_system.name</code>, <code>phenotype_id</code> and <code>phenotype_name</code>. Below is an example of how to view the available phenotypes and obtain the codes.</p>
<div class="section level3">
<h3 id="avaiable-phenotypes">Avaiable phenotypes<a class="anchor" aria-label="anchor" href="#avaiable-phenotypes"></a>
</h3>
<p>For example, view the first 5 phenotypes.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/get_phenotypes.html">get_phenotypes</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="co">#&gt;                         CCU002_02 Cardiomyopathy </span></span>
<span><span class="co">#&gt;                                         "PH1002" </span></span>
<span><span class="co">#&gt;                Acute Myocardial Infarction (AMI) </span></span>
<span><span class="co">#&gt;                                         "PH1024" </span></span>
<span><span class="co">#&gt;                  Heart Failure (fatal/non-fatal) </span></span>
<span><span class="co">#&gt;                                         "PH1028" </span></span>
<span><span class="co">#&gt; Congestive heart failure - Charlson primary care </span></span>
<span><span class="co">#&gt;                                         "PH1055" </span></span>
<span><span class="co">#&gt;    Myocardial infarction - Charlson primary care </span></span>
<span><span class="co">#&gt;                                         "PH1062"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="codes">Codes<a class="anchor" aria-label="anchor" href="#codes"></a>
</h3>
<p>View the codes for <code>PH1645</code> corresponding to the HERMES Heart Failure phenotype.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># top 5 codes</span></span>
<span><span class="fu"><a href="reference/get_codes.html">get_codes</a></span><span class="op">(</span>pheno_id <span class="op">=</span> <span class="st">"PH1645"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"phenotype_id"</span>, <span class="st">"phenotype_name"</span>, <span class="st">"coding_system.name"</span>, <span class="st">"code"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;    phenotype_id phenotype_name coding_system.name   code</span></span>
<span><span class="co">#&gt;          &lt;char&gt;         &lt;char&gt;             &lt;char&gt; &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:       PH1645  Heart failure         ICD9 codes  40201</span></span>
<span><span class="co">#&gt; 2:       PH1645  Heart failure         ICD9 codes  42832</span></span>
<span><span class="co">#&gt; 3:       PH1645  Heart failure         ICD9 codes  42821</span></span>
<span><span class="co">#&gt; 4:       PH1645  Heart failure         ICD9 codes  42823</span></span>
<span><span class="co">#&gt; 5:       PH1645  Heart failure         ICD9 codes  42820</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="phenotyping-a-dataset">Phenotyping a dataset<a class="anchor" aria-label="anchor" href="#phenotyping-a-dataset"></a>
</h3>
<p>Create sample data. This can be in long (only one column containing diagnosis codes) or wide format (multiple columns containing diagnosis codes). <em>n.b. prioritising coding based on diagnosis code position (e.g. primary vs. secondary vs. tertiary positions) is not currently supported.</em></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">n</span>   <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ids   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"ID_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                  codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I420"</span>, <span class="st">"foo"</span>, <span class="st">"bar"</span>, <span class="st">"baz"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, </span>
<span>                  codes1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I420"</span>, <span class="st">"foo"</span>, <span class="st">"bar"</span>, <span class="st">"baz"</span><span class="op">)</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span></span>
<span><span class="co">#&gt;     ids codes codes1</span></span>
<span><span class="co">#&gt; 1  ID_1   baz   I420</span></span>
<span><span class="co">#&gt; 2  ID_2   baz   I420</span></span>
<span><span class="co">#&gt; 3  ID_3   bar    baz</span></span>
<span><span class="co">#&gt; 4  ID_4   foo    baz</span></span>
<span><span class="co">#&gt; 5  ID_5   baz    baz</span></span>
<span><span class="co">#&gt; 6  ID_1  I420    foo</span></span>
<span><span class="co">#&gt; 7  ID_2  I420    foo</span></span>
<span><span class="co">#&gt; 8  ID_3   baz    baz</span></span>
<span><span class="co">#&gt; 9  ID_4   foo    foo</span></span>
<span><span class="co">#&gt; 10 ID_5   foo   I420</span></span></code></pre></div>
<p>Phenotype the individuals with phenotype <code>PH1643</code> (heart failure syndrome) or <code>PH1646</code> (cardiomyopathy), excluding phenotypes <code>PH1637</code> (congenital heart disease) and <code>PH1636</code> (myocardial infarction). There can be multiple included or excluded phenotypes given in a list.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phenotype.html">phenotype</a></span><span class="op">(</span>x         <span class="op">=</span> <span class="va">dat</span>, </span>
<span>                    id_col    <span class="op">=</span> <span class="st">"ids"</span>,</span>
<span>                    code_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ICD10 codes"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"codes"</span>, <span class="st">"codes1"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                    include   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"PH1645"</span><span class="op">)</span>, </span>
<span>                    exclude   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"PH1637"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Phenotyping...</span></span>
<span><span class="co">#&gt; [i] processing 10 records</span></span>
<span><span class="co">#&gt; [i] pivoting data longer</span></span>
<span><span class="co">#&gt; [i] getting inclusion phenotype codes from PhenoID(s) PH1645 </span></span>
<span><span class="co">#&gt; [i] getting exclusion phenotype codes from PhenoID(s) PH1637 </span></span>
<span><span class="co">#&gt; [i] assessing phenotype PH1645 </span></span>
<span><span class="co">#&gt; [i] assessing phenotype PH1637 </span></span>
<span><span class="co">#&gt; [i] summarising phenotyping of participants</span></span>
<span><span class="co">#&gt; [i] finished</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;       ids PH1645 PH1637   none include exclude overall</span></span>
<span><span class="co">#&gt;    &lt;char&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;  &lt;lgcl&gt;  &lt;lgcl&gt;  &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt; 1:   ID_1  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE</span></span>
<span><span class="co">#&gt; 2:   ID_2  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE</span></span>
<span><span class="co">#&gt; 3:   ID_3  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE</span></span>
<span><span class="co">#&gt; 4:   ID_4  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE</span></span>
<span><span class="co">#&gt; 5:   ID_5  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE</span></span></code></pre></div>
<div class="section level4">
<h4 id="code-formatting-issues">Code formatting issues<a class="anchor" aria-label="anchor" href="#code-formatting-issues"></a>
</h4>
<p>Many of the coding systems have slight formating differences - for example an ICD-10 code may appear as <code>I509</code> or <code>I50.9</code> in a dataset. The <code><a href="reference/phenotype.html">phenotype()</a></code> provides a way to clean these codes through use of the <code>gsub</code> argument. This takes a 3 element list: [[1]] is a string representing the regular expression pattern, [[2]] is the replacement string, and [[3]] is a character or character vector which can be one or more of: <code>x</code> (apply to codes in <code>x</code>), <code>pheno</code> (apply to all codes in phenotypes), <code>both</code> (apply to everything), or a valid phenotype ID found in <code>include</code> or <code>exclude</code> (apply to specific phenotype datasets). Other arguments can be passed to <code>gsub</code> through <code>...</code>.</p>
<p>It is important to inspect your dataset (<code>x</code>) and phenotype coding (use <code><a href="reference/get_codes.html">get_codes()</a></code>) prior to running the phenotyping to avoid join issues related to formatting differences.</p>
<p>Output formatting can be changed by altering the inputs. If the phenotype IDs are named, these names are used as column names in the result. The overall result is given in the column <code>overall</code>, although this can be renamed by giving the <code>name</code> parameter.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># change format</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="fl">10</span>, <span class="st">"codes1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"I42.0"</span></span>
<span><span class="va">dat</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;     ids codes codes1</span></span>
<span><span class="co">#&gt; 1  ID_1   baz   I420</span></span>
<span><span class="co">#&gt; 2  ID_2   baz   I420</span></span>
<span><span class="co">#&gt; 3  ID_3   bar    baz</span></span>
<span><span class="co">#&gt; 4  ID_4   foo    baz</span></span>
<span><span class="co">#&gt; 5  ID_5   baz    baz</span></span>
<span><span class="co">#&gt; 6  ID_1  I420    foo</span></span>
<span><span class="co">#&gt; 7  ID_2  I420    foo</span></span>
<span><span class="co">#&gt; 8  ID_3   baz    baz</span></span>
<span><span class="co">#&gt; 9  ID_4   foo    foo</span></span>
<span><span class="co">#&gt; 10 ID_5   foo  I42.0</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># without dealing with the error ID_5 is incorrectly classified as no HF. </span></span>
<span><span class="va">wrong</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phenotype.html">phenotype</a></span><span class="op">(</span>x         <span class="op">=</span> <span class="va">dat</span>, </span>
<span>                   id_col    <span class="op">=</span> <span class="st">"ids"</span>,</span>
<span>                   code_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ICD10 codes"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"codes"</span>, <span class="st">"codes1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   include   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>HF     <span class="op">=</span> <span class="st">"PH1645"</span><span class="op">)</span>, </span>
<span>                   exclude   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>congHD <span class="op">=</span> <span class="st">"PH1637"</span><span class="op">)</span>, </span>
<span>                   name      <span class="op">=</span> <span class="st">"Heart Failure"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Phenotyping...</span></span>
<span><span class="co">#&gt; [i] processing 10 records</span></span>
<span><span class="co">#&gt; [i] pivoting data longer</span></span>
<span><span class="co">#&gt; [i] getting inclusion phenotype codes from PhenoID(s) PH1645 </span></span>
<span><span class="co">#&gt; [i] getting exclusion phenotype codes from PhenoID(s) PH1637 </span></span>
<span><span class="co">#&gt; [i] assessing phenotype PH1645 </span></span>
<span><span class="co">#&gt; [i] assessing phenotype PH1637 </span></span>
<span><span class="co">#&gt; [i] summarising phenotyping of participants</span></span>
<span><span class="co">#&gt; [i] finished</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wrong</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;       ids     HF congHD   none include exclude Heart Failure</span></span>
<span><span class="co">#&gt;    &lt;char&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;  &lt;lgcl&gt;  &lt;lgcl&gt;        &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt; 1:   ID_1  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 2:   ID_2  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 3:   ID_3  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 4:   ID_4  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 5:   ID_5  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># deal with formatting issue using gsub</span></span>
<span><span class="va">pheno</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/phenotype.html">phenotype</a></span><span class="op">(</span>x         <span class="op">=</span> <span class="va">dat</span>, </span>
<span>                   id_col    <span class="op">=</span> <span class="st">"ids"</span>,</span>
<span>                   code_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ICD10 codes"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"codes"</span>, <span class="st">"codes1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   include   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>HF     <span class="op">=</span> <span class="st">"PH1645"</span><span class="op">)</span>, </span>
<span>                   exclude   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>congHD <span class="op">=</span> <span class="st">"PH1637"</span><span class="op">)</span>, </span>
<span>                   gsub      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   name      <span class="op">=</span> <span class="st">"Heart Failure"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Phenotyping...</span></span>
<span><span class="co">#&gt; [i] processing 10 records</span></span>
<span><span class="co">#&gt; [i] pivoting data longer</span></span>
<span><span class="co">#&gt; [i] cleaning input codes with regex [ \. ], replacement [  ]</span></span>
<span><span class="co">#&gt; [i] getting inclusion phenotype codes from PhenoID(s) PH1645 </span></span>
<span><span class="co">#&gt; [i] getting exclusion phenotype codes from PhenoID(s) PH1637 </span></span>
<span><span class="co">#&gt; [i] assessing phenotype PH1645 </span></span>
<span><span class="co">#&gt; [i] assessing phenotype PH1637 </span></span>
<span><span class="co">#&gt; [i] summarising phenotyping of participants</span></span>
<span><span class="co">#&gt; [i] finished</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pheno</span><span class="op">[</span><span class="op">]</span></span>
<span><span class="co">#&gt;       ids     HF congHD   none include exclude Heart Failure</span></span>
<span><span class="co">#&gt;    &lt;char&gt; &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;  &lt;lgcl&gt;  &lt;lgcl&gt;        &lt;lgcl&gt;</span></span>
<span><span class="co">#&gt; 1:   ID_1  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 2:   ID_2  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 3:   ID_3  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 4:   ID_4  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span>
<span><span class="co">#&gt; 5:   ID_5  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level3">
<h3 id="update-library-from-ukhdr">Update library from UKHDR<a class="anchor" aria-label="anchor" href="#update-library-from-ukhdr"></a>
</h3>
<p>This package’s phenotype library can be updated from the <a href="https://phenotypes.healthdatagateway.org/api/v1/" class="external-link">UKHDR Phenotype Library API</a> using the below function. This queries the library for phenotypes matching enteries in the <code>search_terms</code> argument.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/update_library.html">update_library</a></span><span class="op">(</span>search_terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"heart failure"</span>, <span class="st">"cardiomyopathy"</span>, <span class="st">"myocardial infarction"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH25 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH182 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH530 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH531 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH631 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH687 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH968 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH993 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH1028 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH1055 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH1074 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH1603 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH129 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH145 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH185 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH961 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH1002 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH215 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH356 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH481 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH530 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH611 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH612 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH613 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH741 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH886 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH942 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH949 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH988 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH1024 - skipping, already exists</span></span>
<span><span class="co">#&gt; [i] reading phenotype id: PH1062 - skipping, already exists</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="update-library-from-ukhdr-unpublished">Update library from UKHDR (unpublished)<a class="anchor" aria-label="anchor" href="#update-library-from-ukhdr-unpublished"></a>
</h3>
<p>This package’s phenotype library can be updated with unpublished/development phenotypes from the <a href="https://phenotypes.healthdatagateway.org/api/v1/" class="external-link">UKHDR Phenotype Library API</a> using the below function. However, since unpublished phenotypes are not searchable by name, we need to pass the exact ID and also login details for the website (stored in a local <code>.Renviron</code> file in this example.)</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># development phenotypes, ids named for readability only</span></span>
<span><span class="va">hermes_phenos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`Congenital heart disease`    <span class="op">=</span> <span class="st">"PH1637"</span>,</span>
<span>                   `Heart failure`               <span class="op">=</span> <span class="st">"PH1645"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># update</span></span>
<span><span class="fu"><a href="reference/update_library.html">update_library</a></span><span class="op">(</span>search_terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>               ids          <span class="op">=</span> <span class="va">hermes_phenos</span>, </span>
<span>               UKHDR_UN     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"UKHDR_UN"</span><span class="op">)</span>, </span>
<span>               UKHDR_PW     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"UKHDR_PW"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
<div class="section level3">
<h3 id="plotting-phenotype">Plotting phenotype<a class="anchor" aria-label="anchor" href="#plotting-phenotype"></a>
</h3>
<p>To see the intersection of the codes in two or more phenotype files use the <code><a href="reference/plot_code_overlap.html">plot_code_overlap()</a></code> function.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_code_overlap.html">plot_code_overlap</a></span><span class="op">(</span>pheno_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PH1645"</span>, <span class="st">"PH1028"</span>, <span class="st">"PH1055"</span>, <span class="st">"PH1074"</span>, <span class="st">"PH182"</span>, <span class="st">"PH25"</span>, <span class="st">"PH530"</span>, <span class="st">"PH531"</span>, <span class="st">"PH631"</span>, <span class="st">"PH687"</span>, <span class="st">"PH968"</span>, <span class="st">"PH993"</span><span class="op">)</span>, </span>
<span>                  types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ICD10 codes"</span>, <span class="st">"ICD9 codes"</span>, <span class="st">"OPCS4 codes"</span>, <span class="st">"Read codes v2"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="esc-primary-cardiomyopathy-phenotypes">ESC primary cardiomyopathy phenotypes<a class="anchor" aria-label="anchor" href="#esc-primary-cardiomyopathy-phenotypes"></a>
</h3>
<p>The primary cardiomyopathy phenotypes described in the ESC cardiomyopathy guidelines.</p>
<p><img src="reference/figures/esc_phenotypes.png" align="centre" width="80%"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing heRmes</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nicholas Sunderland <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-3625-630X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicholas Sunderland.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
