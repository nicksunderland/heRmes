[{"path":"https://nicksunderland.github.io/heRmes/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 heRmes authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"aim","dir":"Articles","previous_headings":"","what":"Aim","title":"HERMES 3.0 sex-stratified analysis","text":"perform multi-ancestry sex-stratified genome-wide association study (GWAS) meta-analysis HF, ischaemic HF non-ischaemic HF.","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"download-codes","dir":"Articles","previous_headings":"","what":"Download codes","title":"HERMES 3.0 sex-stratified analysis","text":"download codes search strategies clink links: Download hermes_3_codes.tsv Download hermes_3_metadata.tsv","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"rationale","dir":"Articles","previous_headings":"","what":"Rationale","title":"HERMES 3.0 sex-stratified analysis","text":"Heart failure (HF) shown substantial sex differences clinical presentations risk profiles, much remains unclear HF women.1–3 Sex-stratified genome-wide association studies (GWAS) provided mechanistic insights diseases known phenotypic sex differences.4,5 project aims identify sex-specific HF risk loci, performing sex-stratified GWAS -cause HF subtypes stratified ischaemic aetiology, including analysis X chromosome (ChrX). research, particularly analysis non-ischaemic HF, envisioned build new knowledge sex-specific genetic basis HF identify non-traditional risk factors. HF amongst individuals congenital heart disease represents distinct entity, largely due structural malformations embryonic cardiogenesis. Whilst cases remain unexplained, genetic association studies highlighted variants important patterning genes potential causal factors.6 study, interested hearts seemingly developed normally go fail. Given often dramatic structural abnormalities seen congenital heart disease likely distinct pathophysiology (embryonic patterning), excluded subgroup HF definition. Chronic respiratory disease, predominantly COPD, common comorbidity amongst patients diagnosed HF.7 Whilst outcomes poorer HF subgroup, standard HF therapeutics offer similar prognostic benefits suggesting shared underlying pathophysiological mechanisms.7 Diagnosis either, , conditions can challenging due overlapping clinical signs symptoms. However, chronic respiratory disease HF share multiple upstream risk factors - smoking obvious - therefore conditioning chronic respiratory disease status potential induce bias data. Therefore, excluded chronic respiratory disease patients HF definition, long also definite, non-ambiguous, HF diagnostic code.","code":""},{"path":[]},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"methods","dir":"Articles","previous_headings":"","what":"Methods","title":"HERMES 3.0 sex-stratified analysis","text":"Subjects: Individuals European, South Asian, East Asian, African, Hispanic, Indigenous American ancestries free congenital heart disease, without prevalent HF. Genotypes: Autosomal ChrX SNPs (preferably imputed HRC, TOPMED, population-specific haplotypes). Phenotypes: Three phenotypes described (minimum 500 cases 500 controls sex ancestry-specific GWAS analysis).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"return-of-results","dir":"Articles","previous_headings":"","what":"Return of results","title":"HERMES 3.0 sex-stratified analysis","text":"Cardiovascular Knowledge Portal team developed private data repository HERMES3 functionality validate file formats run QC cohort-level GWAS summary data. Please also return results study analysis team UQ via UQRDM. get access UQRDM, please provide analyst email address Clara Jiang j.jiang@uq.edu.au.","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"phenotype-definition","dir":"Articles","previous_headings":"","what":"Phenotype definition","title":"HERMES 3.0 sex-stratified analysis","text":"define phenotypes study, please follow two-step approach described :","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"step-1","dir":"Articles","previous_headings":"Phenotype definition","what":"Step 1","title":"HERMES 3.0 sex-stratified analysis","text":"participant, define status (TRUE / FALSE) following phenotype classifiers: available, manually adjudicated clinical definitions made trained physicians preferred. de novo adjudication using electronic health records, please define classifiers presence least 1 relevant diagnosis/procedure code listed Appendix Ia-c. appropriate, please also include code systems (e.g. READ CPT) mapping recommended codes. self-reported data available, individuals lack HF CAD diagnosis/procedure code, self-report conditions, excluded study. Please contact central analyst team cohort-specific adjudication mentioned .","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"step-2","dir":"Articles","previous_headings":"Phenotype definition","what":"Step 2","title":"HERMES 3.0 sex-stratified analysis","text":"participant, classify status (case/control/exclude) target GWAS phenotypes combining classifier status Step 1 using logic described . Table 1. GWAS Phenotype classifiers -cause HF, ischaemic HF, non-ischaemic HF (phenotypes 1-3) Figure 1. Phenotyping algorithm","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"heart-failure","dir":"Articles","previous_headings":"","what":"Heart Failure","title":"HERMES 3.0 sex-stratified analysis","text":"Definition: Heart failure single pathological diagnosis, clinical syndrome consisting cardinal symptoms (e.g. breathlessness, ankle . swelling, fatigue) may accompanied signs (e.g. elevated . jugular venous pressure, pulmonary crackles, peripheral oedema). due structural /functional abnormality heart results elevated intracardiac pressures /inadequate cardiac output rest /exercise.. Reference: https://www.escardio.org/Guidelines/Clinical-Practice-Guidelines/Acute--Chronic-Heart-Failure. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (84114007) | ((?)(heart|cardiac|ventricular) failure) | ((?)cardiac insufficiency) | ( HF ).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"myocardial-infarction","dir":"Articles","previous_headings":"","what":"Myocardial infarction","title":"HERMES 3.0 sex-stratified analysis","text":"Definition: clinical definition myocardial denotes presence acute myocardial injury detected abnormal cardiac biomarkers setting evidence myocardial injury (new ischaemic ECG changes loss viable myocardium imaging, coronary thrombosis angiography aithopsy).. Reference: https://www.ahajournals.org/doi/10.1161/CIR.0000000000000617. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (22298006) | ((?)myocardial infarction) | ((?)acute ischa?emic heart disease) | ((?)acute .*coronary .*(disease|dysfunction)) | ((?)dressler).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"coronary-artery-bypass-grafting","dir":"Articles","previous_headings":"","what":"Coronary artery bypass grafting","title":"HERMES 3.0 sex-stratified analysis","text":"Definition: Coronary artery bypass graft surgery procedure involves sternotomy bypass diseased segment(s) coronary tree using blood vessels derived parts body connected aorta.. Reference: https://www.nhs.uk/conditions/coronary-artery-bypass-graft-cabg/. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K4[0-9][0-9]?) | (K50[0-9]?|K75[0-9]?) | ((?)coronary (artery )?bypass) | ((?)aortocoronary bypass) | (CABG) | ((?)(graft|replacement|connection|anastomosis|implantation|bypass|repair|operations?|open angioplasty) .*coronary arter(y|ies)) | (232717009).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"percutaneous-coronary-intervention","dir":"Articles","previous_headings":"","what":"Percutaneous coronary intervention","title":"HERMES 3.0 sex-stratified analysis","text":"Definition: Percutaneous coronary intervention (PCI) defined placement angioplasty guidewire, balloon, device (e.g. stent, atherectomy, brachytherapy, thrombectomy catheter) native coronary artery graft purpose mechanical coronary revascularisation. assessment coronary lesion severity fluoroscopy, intracoronary imaging (e.g. intravascular ultrasonography) physiology (e.g. fractional flow reserve) considered PCI procedure.. Reference: https://www.nhs.uk/conditions/coronary-angioplasty/. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K49[0-9]+?|K50[0-9]+|K75[0-9]+) | ((?)percutaneous coronary intervention) | ((?)(percutaneous|transluminal) .*(angioplasty|stent|thrombolysis|thrombectomy|therapeutic|atherectomy|operations|lithotripsy).*coronar(y|ies)) | ((?)(percutaneous|transluminal) .*coronar(y|ies) .*(angioplasty|stent|thrombolysis|thrombectomy|therapeutic|atherectomy|operations|lithotripsy)) | (415070008).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"thrombolysis-coronary","dir":"Articles","previous_headings":"","what":"Thrombolysis (coronary)","title":"HERMES 3.0 sex-stratified analysis","text":"Definition: delivery thrombolytic therapy, either intravenously intracoronary, treatment coronary thrombosis.. Reference: https://www.ahajournals.org/doi/full/10.1161/01.CIR.97.16.1632. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K502) | (coronary thrombolysis) | ((?)thrombolytic) | (thrombolysis) | (32912007).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"congenital-heart-disease","dir":"Articles","previous_headings":"","what":"Congenital heart disease","title":"HERMES 3.0 sex-stratified analysis","text":"Definition: Congenital heart disease encompasses wide range cardiac defects affect normal heart function. fault problems present birth.. Reference: https://www.nhs.uk/conditions/congenital-heart-disease/. Terminologies: ICD9, ICD10, SNOMED. Search expressions: (13213009) | (Q2[0-6][0-9]?) | ((?)congenital.*(heart|cardiac)) | ((?)(heart|cardiac).*congenital) | ((?)congenital .*(pulmonary|tricuspid|aortic|mitral) .*valves?) | ((?)(congenital|transposition) .*great (arter[y|ies]|veins?)) | ((?)fontan|fallot) | ((?)(double outlet|single) .*ventricle) | ((?)(atrial|ventric[ulare]+|aortopulmonary) septal defect) | ((?)cor triatriatum|truncus arteriosus).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/hermes_3.html","id":"congenital-heart-disease-procedure","dir":"Articles","previous_headings":"","what":"Congenital heart disease procedure","title":"HERMES 3.0 sex-stratified analysis","text":"Definition: Congenital heart disease encompasses wide range cardiac defects affect normal heart function. fault problems present birth. concept defines procedures congenital heart disease.. Reference: https://www.nhs.uk/conditions/congenital-heart-disease/. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K[0-3].*) | (K(29[67]|305|336|34[56]|35[467]|36[12]|37[1-6]|38[56]|482|577)) | (K76.*) | (L0.*) | (L1[0-3][0-9]?) | ((?)congenital.*(heart|cardiac)) | ((?)(heart|cardiac).*congenital) | ((?)congenital .*(pulmonary|tricuspid|aortic|mitral) .*valves?) | ((?)(congenital|transposition) .*great (arter[y|ies]|veins?)) | ((?)fontan|norwood|fallot|blalock|mustard|senning|nikaidoh|jatene|rastelli) | ((?)(double outlet|single) .*ventricle) | ((?)(atrial|ventric[ulare]+|aortopulmonary) septal defect) | ((?)cor triatriatum|truncus arteriosus) | (9359[3-7]) | (93594).","code":""},{"path":[]},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"download-codes","dir":"Articles","previous_headings":"","what":"Download codes","title":"Cardiomyopathy phenotyping NIH","text":"download codes search strategies clink links: Download cardiomyopathy_codes.tsv Download cardiomyopathy_metadata.tsv","code":""},{"path":[]},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"classifiers","dir":"Articles","previous_headings":"","what":"Classifiers","title":"Cardiomyopathy phenotyping NIH","text":"Figure 1. Phenotyping algorithm","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"dilated-cardiomyopathy","dir":"Articles","previous_headings":"","what":"Dilated cardiomyopathy","title":"Cardiomyopathy phenotyping NIH","text":"Definition: presence LV dilatation global regional systolic dysfunction unexplained solely abnormal loading conditions (e.g. hypertension, valve disease, congenital heart disease, coronary artery disease. (ESC, 2023). Reference: https://doi.org/10.1093/eurheartj/ehad194. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (399020009) | ((?)cardiomyopath(y|ies)).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"dilated-cardiomyopathy-associated-with","dir":"Articles","previous_headings":"","what":"Dilated cardiomyopathy (associated with)","title":"Cardiomyopathy phenotyping NIH","text":"Definition: presence LV dilatation global regional systolic dysfunction unexplained solely abnormal loading conditions (e.g. hypertension, valve disease, congenital heart disease, coronary artery disease. (ESC, 2023). Reference: https://doi.org/10.1093/eurheartj/ehad194. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (399020009) | ((?)cardiomyopath(y|ies)).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"left-ventricular-systolic-dysfunction","dir":"Articles","previous_headings":"","what":"Left ventricular systolic dysfunction","title":"Cardiomyopathy phenotyping NIH","text":"Definition: Left ventricular systolic dysfunction defined code indicating impaired LV ejection fraction, heart failure reduced mid-range ejection fraction. HF reduced ejection fraction defined HF LVEF<40% HF mid-range ejection fraction LVEF 40-49%.. Reference: https://www.escardio.org/Guidelines/Clinical-Practice-Guidelines/Acute--Chronic-Heart-Failure. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (systolic .*(dys-?function|failure|insufficiency)) | (134401001).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"myocardial-infarction","dir":"Articles","previous_headings":"","what":"Myocardial infarction","title":"Cardiomyopathy phenotyping NIH","text":"Definition: clinical definition myocardial denotes presence acute myocardial injury detected abnormal cardiac biomarkers setting evidence myocardial injury (new ischaemic ECG changes loss viable myocardium imaging, coronary thrombosis angiography aithopsy).. Reference: https://www.ahajournals.org/doi/10.1161/CIR.0000000000000617. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (22298006) | ((?)myocardial infarction) | ((?)acute ischa?emic heart disease) | ((?)acute .*coronary .*(disease|dysfunction)) | ((?)dressler).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"coronary-artery-bypass-grafting","dir":"Articles","previous_headings":"","what":"Coronary artery bypass grafting","title":"Cardiomyopathy phenotyping NIH","text":"Definition: Coronary artery bypass graft surgery procedure involves sternotomy bypass diseased segment(s) coronary tree using blood vessels derived parts body connected aorta.. Reference: https://www.nhs.uk/conditions/coronary-artery-bypass-graft-cabg/. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K4[0-9][0-9]?) | (K50[0-9]?|K75[0-9]?) | ((?)coronary (artery )?bypass) | ((?)aortocoronary bypass) | (CABG) | ((?)(graft|replacement|connection|anastomosis|implantation|bypass|repair|operations?|open angioplasty) .*coronary arter(y|ies)) | (232717009).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"percutaneous-coronary-intervention","dir":"Articles","previous_headings":"","what":"Percutaneous coronary intervention","title":"Cardiomyopathy phenotyping NIH","text":"Definition: Percutaneous coronary intervention (PCI) defined placement angioplasty guidewire, balloon, device (e.g. stent, atherectomy, brachytherapy, thrombectomy catheter) native coronary artery graft purpose mechanical coronary revascularisation. assessment coronary lesion severity fluoroscopy, intracoronary imaging (e.g. intravascular ultrasonography) physiology (e.g. fractional flow reserve) considered PCI procedure.. Reference: https://www.nhs.uk/conditions/coronary-angioplasty/. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K49[0-9]+?|K50[0-9]+|K75[0-9]+) | ((?)percutaneous coronary intervention) | ((?)(percutaneous|transluminal) .*(angioplasty|stent|thrombolysis|thrombectomy|therapeutic|atherectomy|operations|lithotripsy).*coronar(y|ies)) | ((?)(percutaneous|transluminal) .*coronar(y|ies) .*(angioplasty|stent|thrombolysis|thrombectomy|therapeutic|atherectomy|operations|lithotripsy)) | (415070008).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"thrombolysis-coronary","dir":"Articles","previous_headings":"","what":"Thrombolysis (coronary)","title":"Cardiomyopathy phenotyping NIH","text":"Definition: delivery thrombolytic therapy, either intravenously intracoronary, treatment coronary thrombosis.. Reference: https://www.ahajournals.org/doi/full/10.1161/01.CIR.97.16.1632. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K502) | (coronary thrombolysis) | ((?)thrombolytic) | (thrombolysis) | (32912007).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"congenital-heart-disease","dir":"Articles","previous_headings":"","what":"Congenital heart disease","title":"Cardiomyopathy phenotyping NIH","text":"Definition: Congenital heart disease encompasses wide range cardiac defects affect normal heart function. fault problems present birth.. Reference: https://www.nhs.uk/conditions/congenital-heart-disease/. Terminologies: ICD9, ICD10, SNOMED. Search expressions: (13213009) | (Q2[0-6][0-9]?) | ((?)congenital.*(heart|cardiac)) | ((?)(heart|cardiac).*congenital) | ((?)congenital .*(pulmonary|tricuspid|aortic|mitral) .*valves?) | ((?)(congenital|transposition) .*great (arter[y|ies]|veins?)) | ((?)fontan|fallot) | ((?)(double outlet|single) .*ventricle) | ((?)(atrial|ventric[ulare]+|aortopulmonary) septal defect) | ((?)cor triatriatum|truncus arteriosus).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"congenital-heart-disease-procedure","dir":"Articles","previous_headings":"","what":"Congenital heart disease procedure","title":"Cardiomyopathy phenotyping NIH","text":"Definition: Congenital heart disease encompasses wide range cardiac defects affect normal heart function. fault problems present birth. concept defines procedures congenital heart disease.. Reference: https://www.nhs.uk/conditions/congenital-heart-disease/. Terminologies: SNOMED_procedure, OPCS4, CPT4, ICD9_procedure. Search expressions: (K[0-3].*) | (K(29[67]|305|336|34[56]|35[467]|36[12]|37[1-6]|38[56]|482|577)) | (K76.*) | (L0.*) | (L1[0-3][0-9]?) | ((?)congenital.*(heart|cardiac)) | ((?)(heart|cardiac).*congenital) | ((?)congenital .*(pulmonary|tricuspid|aortic|mitral) .*valves?) | ((?)(congenital|transposition) .*great (arter[y|ies]|veins?)) | ((?)fontan|norwood|fallot|blalock|mustard|senning|nikaidoh|jatene|rastelli) | ((?)(double outlet|single) .*ventricle) | ((?)(atrial|ventric[ulare]+|aortopulmonary) septal defect) | ((?)cor triatriatum|truncus arteriosus) | (9359[3-7]) | (93594).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"restrictive-cardiomyopathy","dir":"Articles","previous_headings":"","what":"Restrictive cardiomyopathy","title":"Cardiomyopathy phenotyping NIH","text":"Definition: Restrictive cardiomyopathy (RCM) defined restrictive left /RV pathophysiology presence normal reduced diastolic volumes (one ventricles), normal reduced systolic volumes, normal ventricular wall thickness. (ESC, 2023). Reference: https://doi.org/10.1093/eurheartj/ehad194. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (415295002) | ((?)(restrictive|constrictive) (cardiomyopath.*|heart failure)) | ((?)(cardiomyopath.*|heart failure).*(restrictive|constrictive)).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/nih_cardiomyopathy.html","id":"hypertrophic-cardiomyopathy","dir":"Articles","previous_headings":"","what":"Hypertrophic cardiomyopathy","title":"Cardiomyopathy phenotyping NIH","text":"Definition: Hypertrophic cardiomyopathy (HCM) defined presence increased LV wall thickness (without RV hypertrophy) mass solely explained abnormal loading conditions. (ESC, 2023). Reference: https://doi.org/10.1093/eurheartj/ehad194. Terminologies: SNOMED, ICD10, ICD9. Search expressions: (233873004) | ((?)cardiomyopath(y|ies)).","code":""},{"path":"https://nicksunderland.github.io/heRmes/articles/ukbb_phenotyping.html","id":"example-phenotyping-of-ukbb-data","dir":"Articles","previous_headings":"","what":"Example phenotyping of UKBB data","title":"UKBB phenotyping example","text":"Phenotyping UK biobank hospital admissions data.","code":"pheno_ukbb <- phenotype(file_path,                          id_col    = \"eid\",                          code_cols = list(\"ICD10 codes\" = \"diag_icd10\", \"ICD9 codes\" = \"diag_icd9\"),                         include   = list(HF  = \"PH1645\", CM = \"PH1646\"),                          exclude   = list(congHD = \"PH1637\", MI = \"PH1636\", HCM = \"PH1640\"),                          gsub      = list(\"\\\\.\", \"\", c(\"x\")),                         name      = \"Heart Failure\")  plot(eulerr::euler(pheno_ukbb[, mget(names(pheno_ukbb)[!names(pheno_ukbb) %in% c(\"eid\", \"none\")])], shape = \"circle\"),           quantities = TRUE,           labels     = FALSE,           main       = list(label = \"UKBB Heart failure phenotyping\", fontsize = 8, font = 2),           legend     = list(fontsize = 8))"},{"path":"https://nicksunderland.github.io/heRmes/articles/ukbb_phenotyping.html","id":"plot-the-icd-10-hermes-phenotypes","dir":"Articles","previous_headings":"","what":"Plot the ICD-10 HERMES phenotypes","title":"UKBB phenotyping example","text":"Plot overlap HERMES phenotypes heart failure phenotypes UKHDR Phenotype library.","code":"plot_code_overlap(pheno_ids = hermes_phenos, types = c(\"ICD10 codes\"))"},{"path":"https://nicksunderland.github.io/heRmes/articles/ukbb_phenotyping.html","id":"co-occurrence-of-ukbb-icd-10-codes","dir":"Articles","previous_headings":"","what":"Co-occurrence of UKBB ICD-10 codes","title":"UKBB phenotyping example","text":"Co-occurrence matrix heart failure (PH1645) cardiomyopathy (PH1646) codes.","code":""},{"path":"https://nicksunderland.github.io/heRmes/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Nicholas Sunderland. Author, maintainer.","code":""},{"path":"https://nicksunderland.github.io/heRmes/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Sunderland N (2024). heRmes: Tools Used HERMES Consortium. R package version 0.0.0.9000, https://nicksunderland.github.io/heRmes/.","code":"@Manual{,   title = {heRmes: Tools Used By The HERMES Consortium},   author = {Nicholas Sunderland},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://nicksunderland.github.io/heRmes/}, }"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"hermes-","dir":"","previous_headings":"","what":"Tools Used By The HERMES Consortium","title":"Tools Used By The HERMES Consortium","text":"goal heRmes standardise heart failure phenotyping collections electronic health records.","code":""},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Tools Used By The HERMES Consortium","text":"can install latest version heRmes like :","code":"# install.packages(\"devtools\") devtools::install_github(\"nicksunderland/heRmes\")"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"phenotypes","dir":"","previous_headings":"","what":"Phenotypes","title":"Tools Used By The HERMES Consortium","text":"code lists underpinning various phenotypes stored text files within package structure : inst/extdata/ukhdr_phenotypes. format file matches used UKHDR Phenotype Library, important columns : code, description, coding_system.name, phenotype_id phenotype_name. example view available phenotypes obtain codes.","code":""},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"avaiable-phenotypes","dir":"","previous_headings":"Phenotypes","what":"Avaiable phenotypes","title":"Tools Used By The HERMES Consortium","text":"example, view first 5 phenotypes.","code":"get_phenotypes()[1:5] #>                         CCU002_02 Cardiomyopathy  #>                                         \"PH1002\"  #>                Acute Myocardial Infarction (AMI)  #>                                         \"PH1024\"  #>                  Heart Failure (fatal/non-fatal)  #>                                         \"PH1028\"  #> Congestive heart failure - Charlson primary care  #>                                         \"PH1055\"  #>    Myocardial infarction - Charlson primary care  #>                                         \"PH1062\""},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"codes","dir":"","previous_headings":"Phenotypes","what":"Codes","title":"Tools Used By The HERMES Consortium","text":"View codes PH1645 corresponding HERMES Heart Failure phenotype.","code":"# top 5 codes get_codes(pheno_id = \"PH1645\")[1:5, c(\"phenotype_id\", \"phenotype_name\", \"coding_system.name\", \"code\")] #>    phenotype_id phenotype_name coding_system.name   code #>          <char>         <char>             <char> <char> #> 1:       PH1645  Heart failure         ICD9 codes  40201 #> 2:       PH1645  Heart failure         ICD9 codes  42832 #> 3:       PH1645  Heart failure         ICD9 codes  42821 #> 4:       PH1645  Heart failure         ICD9 codes  42823 #> 5:       PH1645  Heart failure         ICD9 codes  42820"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"phenotyping-a-dataset","dir":"","previous_headings":"Phenotypes","what":"Phenotyping a dataset","title":"Tools Used By The HERMES Consortium","text":"Create sample data. can long (one column containing diagnosis codes) wide format (multiple columns containing diagnosis codes). n.b. prioritising coding based diagnosis code position (e.g. primary vs. secondary vs. tertiary positions) currently supported. Phenotype individuals phenotype PH1643 (heart failure syndrome) PH1646 (cardiomyopathy), excluding phenotypes PH1637 (congenital heart disease) PH1636 (myocardial infarction). can multiple included excluded phenotypes given list.","code":"set.seed(2020) n   <- 10 dat <- data.frame(ids   = paste0(\"ID_\", c(1:(n/2), 1:(n/2))),                    codes = sample(c(\"I420\", \"foo\", \"bar\", \"baz\"), n, replace = TRUE),                    codes1 = sample(c(\"I420\", \"foo\", \"bar\", \"baz\"), n, replace = TRUE)) dat #>     ids codes codes1 #> 1  ID_1   baz   I420 #> 2  ID_2   baz   I420 #> 3  ID_3   bar    baz #> 4  ID_4   foo    baz #> 5  ID_5   baz    baz #> 6  ID_1  I420    foo #> 7  ID_2  I420    foo #> 8  ID_3   baz    baz #> 9  ID_4   foo    foo #> 10 ID_5   foo   I420 result <- phenotype(x         = dat,                      id_col    = \"ids\",                     code_cols = list(\"ICD10 codes\" = c(\"codes\", \"codes1\")),                      include   = list(\"PH1645\"),                      exclude   = list(\"PH1637\")) #> Phenotyping... #> [i] processing 10 records #> [i] pivoting data longer #> [i] getting inclusion phenotype codes from PhenoID(s) PH1645  #> [i] getting exclusion phenotype codes from PhenoID(s) PH1637  #> [i] assessing phenotype PH1645  #> [i] assessing phenotype PH1637  #> [i] summarising phenotyping of participants #> [i] finished result[] #>       ids PH1645 PH1637   none include exclude overall #>    <char> <lgcl> <lgcl> <lgcl>  <lgcl>  <lgcl>  <lgcl> #> 1:   ID_1  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE #> 2:   ID_2  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE #> 3:   ID_3  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE #> 4:   ID_4  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE #> 5:   ID_5  FALSE  FALSE   TRUE   FALSE   FALSE   FALSE"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"code-formatting-issues","dir":"","previous_headings":"Phenotypes > Phenotyping a dataset","what":"Code formatting issues","title":"Tools Used By The HERMES Consortium","text":"Many coding systems slight formating differences - example ICD-10 code may appear I509 I50.9 dataset. phenotype() provides way clean codes use gsub argument. takes 3 element list: [[1]] string representing regular expression pattern, [[2]] replacement string, [[3]] character character vector can one : x (apply codes x), pheno (apply codes phenotypes), (apply everything), valid phenotype ID found include exclude (apply specific phenotype datasets). arguments can passed gsub .... important inspect dataset (x) phenotype coding (use get_codes()) prior running phenotyping avoid join issues related formatting differences. Output formatting can changed altering inputs. phenotype IDs named, names used column names result. overall result given column overall, although can renamed giving name parameter.","code":"# change format dat[10, \"codes1\"] <- \"I42.0\" dat[] #>     ids codes codes1 #> 1  ID_1   baz   I420 #> 2  ID_2   baz   I420 #> 3  ID_3   bar    baz #> 4  ID_4   foo    baz #> 5  ID_5   baz    baz #> 6  ID_1  I420    foo #> 7  ID_2  I420    foo #> 8  ID_3   baz    baz #> 9  ID_4   foo    foo #> 10 ID_5   foo  I42.0 # without dealing with the error ID_5 is incorrectly classified as no HF.  wrong <- phenotype(x         = dat,                     id_col    = \"ids\",                    code_cols = list(\"ICD10 codes\" = c(\"codes\", \"codes1\")),                    include   = list(HF     = \"PH1645\"),                     exclude   = list(congHD = \"PH1637\"),                     name      = \"Heart Failure\") #> Phenotyping... #> [i] processing 10 records #> [i] pivoting data longer #> [i] getting inclusion phenotype codes from PhenoID(s) PH1645  #> [i] getting exclusion phenotype codes from PhenoID(s) PH1637  #> [i] assessing phenotype PH1645  #> [i] assessing phenotype PH1637  #> [i] summarising phenotyping of participants #> [i] finished wrong[] #>       ids     HF congHD   none include exclude Heart Failure #>    <char> <lgcl> <lgcl> <lgcl>  <lgcl>  <lgcl>        <lgcl> #> 1:   ID_1  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 2:   ID_2  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 3:   ID_3  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 4:   ID_4  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 5:   ID_5  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE # deal with formatting issue using gsub pheno <- phenotype(x         = dat,                     id_col    = \"ids\",                    code_cols = list(\"ICD10 codes\" = c(\"codes\", \"codes1\")),                    include   = list(HF     = \"PH1645\"),                     exclude   = list(congHD = \"PH1637\"),                     gsub      = list(\"\\\\.\", \"\", c(\"x\")),                    name      = \"Heart Failure\") #> Phenotyping... #> [i] processing 10 records #> [i] pivoting data longer #> [i] cleaning input codes with regex [ \\. ], replacement [  ] #> [i] getting inclusion phenotype codes from PhenoID(s) PH1645  #> [i] getting exclusion phenotype codes from PhenoID(s) PH1637  #> [i] assessing phenotype PH1645  #> [i] assessing phenotype PH1637  #> [i] summarising phenotyping of participants #> [i] finished pheno[] #>       ids     HF congHD   none include exclude Heart Failure #>    <char> <lgcl> <lgcl> <lgcl>  <lgcl>  <lgcl>        <lgcl> #> 1:   ID_1  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 2:   ID_2  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 3:   ID_3  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 4:   ID_4  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE #> 5:   ID_5  FALSE  FALSE   TRUE   FALSE   FALSE         FALSE"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"update-library-from-ukhdr","dir":"","previous_headings":"Phenotypes","what":"Update library from UKHDR","title":"Tools Used By The HERMES Consortium","text":"package’s phenotype library can updated UKHDR Phenotype Library API using function. queries library phenotypes matching enteries search_terms argument.","code":"update_library(search_terms = c(\"heart failure\", \"cardiomyopathy\", \"myocardial infarction\")) #> [i] reading phenotype id: PH25 - skipping, already exists #> [i] reading phenotype id: PH182 - skipping, already exists #> [i] reading phenotype id: PH530 - skipping, already exists #> [i] reading phenotype id: PH531 - skipping, already exists #> [i] reading phenotype id: PH631 - skipping, already exists #> [i] reading phenotype id: PH687 - skipping, already exists #> [i] reading phenotype id: PH968 - skipping, already exists #> [i] reading phenotype id: PH993 - skipping, already exists #> [i] reading phenotype id: PH1028 - skipping, already exists #> [i] reading phenotype id: PH1055 - skipping, already exists #> [i] reading phenotype id: PH1074 - skipping, already exists #> [i] reading phenotype id: PH1603 - skipping, already exists #> [i] reading phenotype id: PH129 - skipping, already exists #> [i] reading phenotype id: PH145 - skipping, already exists #> [i] reading phenotype id: PH185 - skipping, already exists #> [i] reading phenotype id: PH961 - skipping, already exists #> [i] reading phenotype id: PH1002 - skipping, already exists #> [i] reading phenotype id: PH215 - skipping, already exists #> [i] reading phenotype id: PH356 - skipping, already exists #> [i] reading phenotype id: PH481 - skipping, already exists #> [i] reading phenotype id: PH530 - skipping, already exists #> [i] reading phenotype id: PH611 - skipping, already exists #> [i] reading phenotype id: PH612 - skipping, already exists #> [i] reading phenotype id: PH613 - skipping, already exists #> [i] reading phenotype id: PH741 - skipping, already exists #> [i] reading phenotype id: PH886 - skipping, already exists #> [i] reading phenotype id: PH942 - skipping, already exists #> [i] reading phenotype id: PH949 - skipping, already exists #> [i] reading phenotype id: PH988 - skipping, already exists #> [i] reading phenotype id: PH1024 - skipping, already exists #> [i] reading phenotype id: PH1062 - skipping, already exists"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"update-library-from-ukhdr-unpublished","dir":"","previous_headings":"Phenotypes","what":"Update library from UKHDR (unpublished)","title":"Tools Used By The HERMES Consortium","text":"package’s phenotype library can updated unpublished/development phenotypes UKHDR Phenotype Library API using function. However, since unpublished phenotypes searchable name, need pass exact ID also login details website (stored local .Renviron file example.)","code":"# development phenotypes, ids named for readability only hermes_phenos <- c(`Congenital heart disease`    = \"PH1637\",                    `Heart failure`               = \"PH1645\")  # update update_library(search_terms = c(),                 ids          = hermes_phenos,                 UKHDR_UN     = Sys.getenv(\"UKHDR_UN\"),                 UKHDR_PW     = Sys.getenv(\"UKHDR_PW\"))"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"plotting-phenotype","dir":"","previous_headings":"Phenotypes","what":"Plotting phenotype","title":"Tools Used By The HERMES Consortium","text":"see intersection codes two phenotype files use plot_code_overlap() function.","code":"plot_code_overlap(pheno_ids = c(\"PH1645\", \"PH1028\", \"PH1055\", \"PH1074\", \"PH182\", \"PH25\", \"PH530\", \"PH531\", \"PH631\", \"PH687\", \"PH968\", \"PH993\"),                    types = c(\"ICD10 codes\", \"ICD9 codes\", \"OPCS4 codes\", \"Read codes v2\"))"},{"path":"https://nicksunderland.github.io/heRmes/index.html","id":"esc-primary-cardiomyopathy-phenotypes","dir":"","previous_headings":"Phenotypes","what":"ESC primary cardiomyopathy phenotypes","title":"Tools Used By The HERMES Consortium","text":"primary cardiomyopathy phenotypes described ESC cardiomyopathy guidelines.","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_codes.html","id":null,"dir":"Reference","previous_headings":"","what":"get phenotype codes — get_codes","title":"get phenotype codes — get_codes","text":"get phenotype codes","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_codes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get phenotype codes — get_codes","text":"","code":"get_codes(pheno_id, strip = \"\\\\.\")"},{"path":"https://nicksunderland.github.io/heRmes/reference/get_codes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get phenotype codes — get_codes","text":"pheno_id string, valid phenotype id (see get_phenotypes()) strip regular expression strip codes, NULL stripping","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_codes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get phenotype codes — get_codes","text":"data.table","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"get phenotype meta-data — get_metadata","title":"get phenotype meta-data — get_metadata","text":"get phenotype meta-data","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get phenotype meta-data — get_metadata","text":"","code":"get_metadata(pheno_id)"},{"path":"https://nicksunderland.github.io/heRmes/reference/get_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get phenotype meta-data — get_metadata","text":"pheno_id string, valid phenotype id (see get_phenotypes())","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"get phenotype meta-data — get_metadata","text":"data.table","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_phenotypes.html","id":null,"dir":"Reference","previous_headings":"","what":"Get phenotypes — get_phenotypes","title":"Get phenotypes — get_phenotypes","text":"Get phenotypes","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/get_phenotypes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get phenotypes — get_phenotypes","text":"","code":"get_phenotypes()"},{"path":"https://nicksunderland.github.io/heRmes/reference/get_phenotypes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get phenotypes — get_phenotypes","text":"character vector potential phenotypes","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/heRmes-package.html","id":null,"dir":"Reference","previous_headings":"","what":"heRmes: Tools Used By The HERMES Consortium — heRmes-package","title":"heRmes: Tools Used By The HERMES Consortium — heRmes-package","text":"collection tools phenotyping processing heart failure GWAS data.","code":""},{"path":[]},{"path":"https://nicksunderland.github.io/heRmes/reference/heRmes-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"heRmes: Tools Used By The HERMES Consortium — heRmes-package","text":"Maintainer: Nicholas Sunderland nicholas.sunderland@bristol.ac.uk (ORCID)","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/phenotype.html","id":null,"dir":"Reference","previous_headings":"","what":"Phenotype — phenotype","title":"Phenotype — phenotype","text":"Phenotype","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/phenotype.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Phenotype — phenotype","text":"","code":"phenotype(   x,   id_col,   include,   exclude = NULL,   code_cols = list(`ICD9 codes` = NULL, `ICD10 codes` = NULL, `OPCS4 codes` = NULL,     `Read codes v2` = NULL, `Read codes v3` = NULL),   gsub = NULL,   name = \"overall\",   include_multi = \"any\",   exclude_multi = \"any\",   verbose = TRUE,   ... )"},{"path":"https://nicksunderland.github.io/heRmes/reference/phenotype.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Phenotype — phenotype","text":"x data.frame like object file path readable data.table::fread id_col string, name id column include string list strings, valid phenotype id (see get_phenotypes()) exclude string list strings, valid phenotype id (see get_phenotypes()) code_cols list named strings, diagnosis procedure code column(s). List elements must one icd9, icd10, opcs, readv2, readv3 gsub list characters length 3, pre-processing phenotype codes /codes x. E.g. c(\".\", \"\", \"\"). NULL turn . Element 1: character, regex pattern. Element 2: character, replacement string. Element 3: character vector, one : 'x' (apply codes x ), 'pheno' (apply codes pheno files ), '' (apply x pheno files), phenotype_id include exclude (apply phenotype). name string, name phenotype include_multi string, deal multiple include phenotypes, either '' (required) '' (required) exclude_multi string, deal multiple exclude phenotypes, either '' (required) '' (required) verbose logical, print progress ... parameters passed gsub","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/phenotype.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Phenotype — phenotype","text":"data.table","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/plot_code_overlap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot phenotype code overlap — plot_code_overlap","title":"Plot phenotype code overlap — plot_code_overlap","text":"Plot phenotype code overlap","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/plot_code_overlap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot phenotype code overlap — plot_code_overlap","text":"","code":"plot_code_overlap(   pheno_ids = c(\"PH_HF_HERMES_3.0\", \"PH25\", \"PH129\"),   types = c(\"ICD10 codes\", \"ICD9 codes\", \"OPCS4 codes\", \"Read codes v2\", \"Med codes\",     \"SNOMED  CT codes\", \"OXMIS codes\") )"},{"path":"https://nicksunderland.github.io/heRmes/reference/plot_code_overlap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot phenotype code overlap — plot_code_overlap","text":"pheno_ids list strings, valid phenotype IDs types vector strings, one c(\"ICD10 codes\", \"ICD9 codes\", \"OPCS4 codes\", \"Read codes v2\", \"Med codes\", \"SNOMED  CT codes\", \"OXMIS codes\")","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/plot_code_overlap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot phenotype code overlap — plot_code_overlap","text":"plot","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/update_library.html","id":null,"dir":"Reference","previous_headings":"","what":"Update code library — update_library","title":"Update code library — update_library","text":"Update internal code library Concept Library API","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/update_library.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update code library — update_library","text":"","code":"update_library(   search_terms = c(\"heart failure\", \"cardiomyopathy\", \"myocardial infarction\"),   ids = NULL,   UKHDR_UN = NULL,   UKHDR_PW = NULL )"},{"path":"https://nicksunderland.github.io/heRmes/reference/update_library.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update code library — update_library","text":"search_terms vector strings search concept library phenotypes ids vector phenotypes IDs pull UKHDR_UN UK-HDR website username (pulling unpublished phenotypes) UKHDR_PW UK-HDR website password (pulling unpublished phenotypes)","code":""},{"path":"https://nicksunderland.github.io/heRmes/reference/update_library.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update code library — update_library","text":"boolean, success status","code":""}]
